// Place all the behaviors and hooks related to the matching controller here.
// All this logic will automatically be available in application.js.


$(".add_places").click(function() {
  center = mymap.getCenter();
  $.ajax({url: "/add_place", type: 'POST', data: 'lati=' + center.lat + "&long=" + center.lng, dataType: 'JSON', body: 'rendu', complete: ( function(data) {
    let local = data.responseJSON.rendu
    let place = new L.latLng(local.latitude, local.longitude );
    let myIcon = new L.icon({ iconUrl: "<%= asset_path("douge.png") %>", iconSize: [45, 50]});
    let marker = new L.Marker(place, {icon: myIcon, autoPan: true});
    marker.addTo(mymap);
  })
  });});


$(".adress").click(function() {
  center = mymap.getCenter();
  $.ajax({url: "/find_adress", type: 'POST', data: 'lati=' + center.lat + "&long=" + center.lng, dataType: 'JSON', body: 'rendu', complete: ( function(data) {
    let local = data.responseJSON.rendu
    let place = new L.latLng(local.latitude, local.longitude );
    let myIcon = new L.icon({ iconUrl: "<%= asset_path("douge.png") %>", iconSize: [45, 50]});
    let marker = new L.Marker(place, {icon: myIcon, autoPan: true});
    marker.addTo(mymap);
  })
  });});

$("#find").click(function () {
  if ($("#address")[0].value === "" ) {
    alert("champs address vide");
    return (0);
  }

  $.ajax({url: "/find_address", type: 'POST', data: 'address=' + $("#address")[0].value , dataType: 'JSON', body: 'rendu', complete: ( function(data) {
    let local = data.responseJSON.rendu;
    let place = new L.latLng(local.latitude, local.longitude );
    let myIcon = new L.icon({ iconUrl: "<%= asset_path("douge.png") %>", iconSize: [45, 50]});
    let marker = new L.Marker(place, {icon: myIcon, autoPan: true, draggable: true});
      marker.addTo(mymap);
      toggleModal();
    a = document.createElement("div");
      $(a).addClass("add")
      .value("OK ?")
      .margin-top = "80px"
      .border-radius = "80%"
      .addTo(mymap);
  })});






